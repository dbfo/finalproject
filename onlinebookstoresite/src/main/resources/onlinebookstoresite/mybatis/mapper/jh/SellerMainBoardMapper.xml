<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jhta.mybatis.mapper.SellerMainBoardMapper.jh">
	<!-- 중고판매자 상황판 관련 Mapper파일 -->

	<!-- 최근 한달간 등록 상품 -->
	<select id="getOldbookCount" resultType="int" parameterType="int">
		select NVL(count(*),0) count from oldbooks where obregdate >= TO_DATE(add_months(sysdate,-1)) and snum=#{snum}
	</select>
	<!-- 최근 한달간 판매현황(0:주문/입금대기중,1:결제완료,2:배송중,3:수령완료(구매확정)) -->
	<select id="getOldbookSalestatusCount" resultType="int" parameterType="hashmap">
		select NVL(count(distinct(pay)),0) count from (
		   select bp.bpaynum pay from 
		   bpayment b,oldbooks o,paymentbook bp,members m 
		   where o.snum=#{snum} and b.bstatus=#{bstatus} and b.bpaynum=bp.bpaynum 
		   and bp.bnum=o.obnum and m.mnum=b.mnum and borderdate >= TO_DATE(add_months(sysdate,-1)))
	</select>
	
</mapper>